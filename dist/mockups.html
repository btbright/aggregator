<!doctype html>
<html class="no-js" lang="">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>mockups</title>
        <link rel="stylesheet" media="all" href="css/normalize.css" />
        <style>
          body {
                background: #fbfbfb;
                color: rgba(0,0,0,.5);
                font: 16px "Helvetica Neue",Helvetica,Arial,sans-serif;
          }

          .wrapper {
            width:500px;
            min-height:300px;
            margin:50px auto 0;
            background: #f3f3f3;
            position: relative;
          }

          #chat {
            position:absolute;
            height:100%;
            width:100%;
          }
          .comment-form {
            position:absolute;
            bottom:0px;
            width:100%;
            height:38px;
          }
          .comment-form .comment-box {
            width:100%;
            height:100%;
            box-sizing: border-box;
            outline:none;
            border:none;
            background: #e9e9e9;
            padding: 10px;
          }
          .comment-form .comment-box:-moz-placeholder { /* Firefox 18- */
             color:#ccc;
             font-weight: 300;
          }
          .comment-form .comment-box::-moz-placeholder {  /* Firefox 19+ */
             color:#ccc;
             font-weight: 300;
          }

          .comment-form .comment-box:-ms-input-placeholder {  
             color:#ccc;
             font-weight: 300;
          }
          .comment-form .comment-box::-webkit-input-placeholder {
             color:#ccc;
             font-weight: 300;
          }
          .comment-form .submit-instructions {
            position:absolute;
            right:10px;
            top:50%;
            margin-top:-.5em;
            font-size: 13px;
            color:rgba(0,0,0,.2);
            opacity: 0;
            transition:opacity .4s;
          }
          .has-entered-text .submit-instructions {
            opacity: 1;
          }
          .space-conflict .submit-instructions {
            opacity: 0;
          }
          .comment {
            width:100%;
            position: relative;
            padding:5px 50px 5px 10px;
            box-sizing:border-box;
            cursor: pointer;
            transition:background .07s;
          }
          .comment.has-clicked {
            border-right:2px solid #ffb600;
          }
          .comment-aggregated .aggregator-indicator {
            height: 100%;
            background: rgba(51, 195, 51,0.1);
            position: absolute;
            right: -41px;
            top: 0px;
            padding: 5px;
            padding-right: 8px;
            z-index: -2;
            border-right: 2px solid #33C333;
            box-sizing: border-box;
            font-size: 12px;
          }
          .has-clicked .aggregator-indicator {
            right:-43px;
          }
          .comment-aggregated .aggregator-indicator 
          .comment-aggregated .aggregator-indicator .vote-count,
          .comment-aggregated .aggregator-indicator .vote-label {
            text-align: center;
          }
          .comment-aggregated .aggregator-indicator .vote-count {
            
          }
          .comment-aggregated .aggregator-indicator .vote-label {
            transform: rotate(-90deg);
            display: block;
            float: right;
            font-size: 17px;
            position: relative;
            bottom: 4px;
            margin-left: 2px;
          }
          .comment:hover {
            background: #e7e7e7;
          }
          .comment:first-child {
            margin-top:0;
          }
          .comment-time {
            position: absolute;
            right: 10px;
            top: 8px;
            font-size: .7em;
            color: #ccc;
          }
          .has-clicked .comment-time {
            right:8px;
          }
          .comment-text,.comment-meta {
            float:left;
          }
          .comment-text {
            margin:0;
          }
          .comment-meta {
            margin-right:5px;
          }
          .comment-meta .author {
            font-weight: bold;
            position: relative;
            bottom: 1px;
          }
        </style>
    </head>
    <body>
       <div class="wrapper">
          <div id="chat">
            <div id="comment-list">
              <div class="comment clearfix">
                <span class="comment-time">9:30pm</span>
                <p class="comment-text">
                  <span class="comment-meta">
                    <span class="author">Steve:</span>
                  </span>
                  Lorem ipsum dolor sit amet, consectetur adipiscing elit.
                </p>
              </div>
              <div class="comment comment-aggregated has-clicked clearfix">
                <div class="aggregator-indicator">
                  <p>
                    <span class="vote-count">19</span>
                    <span class="vote-label">&#8694;</span>
                  </p>
                </div>
                <span class="comment-time">9:31pm</span>
                <div class="comment-meta">
                  <span class="author">Fred:</span>
                </div>
                <p class="comment-text">Ipsum dolor sit lorem amet, consectetur elit adipiscing.</p>
              </div>
            </div>
            <form class="comment-form">
              <input type="text" class="comment-box" placeholder="Enter a comment here..." />
              <span class="submit-instructions">Press Enter To Submit</span>
            </form>
          </div>
       </div>
       <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
       <script>
        $.fn.textWidth = function(text, font) {
            if (!$.fn.textWidth.fakeEl) $.fn.textWidth.fakeEl = $('<span>').hide().appendTo(document.body);
            var htmlText = text || this.val() || this.text();
            htmlText = $.fn.textWidth.fakeEl.text(htmlText).html(); //encode to Html
            htmlText = htmlText.replace(/\s/g, "&nbsp;"); //replace trailing and leading spaces
            $.fn.textWidth.fakeEl.html(htmlText).css('font', font || this.css('font'));
            return $.fn.textWidth.fakeEl.width();
        };

         $(function(){
          $(".comment").on("click",function(){
            $(this).toggleClass("has-clicked");
          });

          $(".comment-box").on("keyup",function(){
            var $this = $(this);
            var $commentForm = $(".comment-form");
            var $instructions = $(".submit-instructions");
            var textWidth = $this.textWidth();
            var submitInstructionsWidth = $instructions.textWidth();
            var inputWidth = $this.width();
            if (inputWidth-submitInstructionsWidth<=textWidth+60){
              $commentForm.addClass("space-conflict");
            } else {
              $commentForm.removeClass("space-conflict");
            }

            if ($this.val()){
              $commentForm.addClass("has-entered-text");
            } else {
              $commentForm.removeClass("has-entered-text");
            }
          });
         });
       </script>      
    </body>
</html>
